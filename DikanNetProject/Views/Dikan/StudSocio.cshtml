@model DataEntities.SpSocio

@{
    ViewBag.Title = "מלגת סוציו";
    Layout = "~/Views/Dikan/_Layout.cshtml";
}

<div class="w-75 mx-auto">
    <h4>מלגת @Html.DisplayFor(model => model.ScholarshipDefinition.ScholarshipName)</h4>
    <hr />
    @Html.Partial("StudentDetails", Model.Student)
<dl class="dl-horizontal">
    <dt>
        @Html.DisplayNameFor(model => model.Apartment)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.Apartment)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.PathApartmentLease)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.PathApartmentLease)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.Newcomer)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.Newcomer)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.DateImmigration)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.DateImmigration)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.PathNewcomer)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.PathNewcomer)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.SingleParent)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.SingleParent)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.PathSingleParent)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.PathSingleParent)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.BereavedFam)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.BereavedFam)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.PathBereavedFam)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.PathBereavedFam)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.ReceiveScholarship)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.ReceiveScholarship)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.MilitaryService)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.MilitaryService)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.PathMilitaryService)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.PathMilitaryService)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.ReserveMilitaryService)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.ReserveMilitaryService)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.PathReserveMilitaryService)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.PathReserveMilitaryService)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.HasFunding)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.HasFunding)
    </dd>


    @foreach (var fund in Model.Student.Fundings.ToList())
    {
        <dt> @Html.DisplayNameFor(Model => fund.FinancingInstitution) - @Html.DisplayNameFor(Model => fund.FinancingHeight) - @Html.DisplayNameFor(Model => fund.YearFinancing) </dt>

        <dd>@fund.FinancingInstitution - @fund.FinancingHeight - @fund.YearFinancing @fund.PathFunding כפתור קובץ</dd>
    }

    <dt>
        @Html.DisplayNameFor(model => model.CarOwner)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.CarOwner)
    </dd>

    @foreach (var car in Model.Student.CarStudents.ToList())
    {
        <dt> @Html.DisplayNameFor(Model => car.CarNumber) - @Html.DisplayNameFor(Model => car.CarCompany) - @Html.DisplayNameFor(Model => car.CarModel) </dt>

        <dd>@car.CarNumber - @car.CarCompany - @car.CarModel @car.PathCarLicense כפתור קובץ</dd>
    }

    <dt>
        @Html.DisplayNameFor(model => model.DisabilityType)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.DisabilityType)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.PathDisabilityType)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.PathDisabilityType)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.WorkSt)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.WorkSt)
    </dd>

    <dt>
        @Html.DisplayNameFor(model => model.Comments)
    </dt>

    <dd>
        @Html.DisplayFor(model => model.Comments)
    </dd>
</dl>
    <div>
        @Html.DropDownListFor(model => model.Statuss,
            new SelectList(Enum.GetValues(typeof(Common.Enums.Status))), "", new
            { @class = "form-control chosen", @data_placeholder = "בחר סטטוס", @id = "new-status" })
        <br /><br />
        <button class="btn btn-success" id="update-status">עדכן סטטוס</button>
        @Html.ActionLink("חזרה לטבלה", "SubmitedSp", new { spId = Model.ScholarshipId, spType = Model.ScholarshipDefinition.Type }, new { @class = "btn btn-danger" })
    </div>
</div>

@section scripts{
    <script>
        $('#update-status').click(function () {
            $.ajax({
                url: "/Dikan/UpdateSpStatus",
                dataType: 'text',
                data: {ScholarId: @Model.ScholarshipId, StudId: @Model.StudentId, status: $('#new-status').val() },
	            method: "POST",
                success: function () {
                    // show success message
                    alert('סטטוס עודכן בהצלחה');
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    console.log(xhr.status);
                    console.log(thrownError);
                }
            });
        });
    </script>
}
